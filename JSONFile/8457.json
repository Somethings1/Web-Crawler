{"summary":"A whitehat hacker Kankodu claimed that a fix to a bug report submitted by them inadvertently resulted in an attack on Euler Finance in March 2023.","webName":"theblock.co","link":"https:\/\/www.theblock.co\/post\/249413\/euler-finance-whitehat-unknowingly-caused-200-million-hack","publishDate":"2023-09-06T10:47:18","id":8457,"type":null,"title":"Whitehat claims a bug fix inadvertently led to the $200M Euler attack","category":["SECURITY"],"content":["A pseudonymous whitehat known as Kankodu <a href=\"https:\/\/twitter.com\/kankodu\/status\/1698992717089604064?s=46&amp;t=v4MeJk18PFydz-g2BpdAVg\" data-v-f87c67ca=\"\">claimed<\/a> they submitted a bug bounty report that introduced a specific vulnerability on Euler Finance, subsequently resulting in $200 million attack on the decentralized lending protocol in March.","\"The fix for a bug that I reported ended up introducing a function responsible for the hack,\" wrote Kankodu in a post on X (formerly Twitter) yesterday.","<span data-v-f87c67ca=\"\">On Euler, users can lend assets and receive liquidity provider tokens, known as eTokens, in return. These eTokens, such as eDAI for <span class=\"articleTooltip\" data-v-baf5685a=\"\" data-v-f87c67ca=\"\"><a href=\"\/price\/248365\/dai-dai-usd\" class=\"articleTooltip__link\" data-v-baf5685a=\"\"><img src=\"https:\/\/www.tbstat.com\/wp\/uploads\/2023\/10\/Badge_Dai.png\" alt=\"\" title=\"\" class=\"articleTooltip__tokenImage\" data-v-baf5685a=\"\"> <span class=\"articleTooltip__tokenText\" data-v-baf5685a=\"\">DAI<\/span> <span class=\"articleTooltip__tokenText articleTooltip__tokenText_price articleTooltip__tokenText_negative\" data-v-baf5685a=\"\">\n      -0.040%\n    <\/span><\/a> <!----><\/span> deposits, represent the underlying asset deposited plus any interest earned. The amount of eTokens given is determined by an exchange rate that factors in the interest on the deposited asset.<\/span>","Kankodu said that in July 2022, they reported the Euler \u201C<a href=\"https:\/\/github.com\/euler-xyz\/euler-contracts\/commit\/85abe8d0986f97557159d26c5e79df6d78eccc53\" data-v-f87c67ca=\"\">first deposit bug<\/a>,\u201D which is a separate issue from the March incident. This bug, which Kankudo found, could have allowed attackers to exploit Euler by artificially inflating exchange rates, enabling them to withdraw all tokens. They added that the Euler team awarded them $50,000 for the discovery.","Kankodu is a crypto whitehat, a term for an ethical hacker, <a href=\"https:\/\/immunefi.com\/leaderboard\/\" data-v-f87c67ca=\"\">ranking 17th at web3 bug bounty platform Immunefi<\/a>, having submitted 28 paid reports with total earnings of $689,000.","<span data-v-f87c67ca=\"\">To address the specific vulnerability, Kankodu stated that Euler implemented a feature where all new eTokens began with a total supply and reserve of 1 million wei, the smallest unit of ether. This change rendered an initial attack economically unfeasible. According to Kankodu, the approach mirrored that of <span data-v-f87c67ca=\"\"><span data-v-f87c67ca=\"\">Uniswap <\/span><span class=\"articleTooltip\" data-v-baf5685a=\"\" data-v-f87c67ca=\"\"><a href=\"\/price\/248366\/uniswap-uni-usd\" class=\"articleTooltip__link\" data-v-baf5685a=\"\"><img src=\"https:\/\/www.tbstat.com\/wp\/uploads\/2023\/10\/uni.jpg\" alt=\"\" title=\"\" class=\"articleTooltip__tokenImage\" data-v-baf5685a=\"\"> <span class=\"articleTooltip__tokenText\" data-v-baf5685a=\"\">UNI<\/span> <span class=\"articleTooltip__tokenText articleTooltip__tokenText_price articleTooltip__tokenText_negative\" data-v-baf5685a=\"\">\n      -5.64%\n    <\/span><\/a> <!----><\/span><\/span> version 2 and was effective for new eTokens.<\/span>","For existing eTokens with reserves below 1 million wei, Euler added a function called \u201CdonateToReserves.\u201D While the function was designed to bring reserves above the 1 million wei threshold, it inadvertently created a larger vulnerability. The $200 million attack was executed by exploiting this \u201CdonateToReserves\u201D function in combination with Euler\u2019s unique liquidation mechanism.","\u201CThe white hat submitted the bug referenced in the tweet through Immunefi. Euler had a $1m bounty on offer for critical bugs at the time, but a $50k bounty was paid for this particular finding given its lower severity. Once a fix was developed, it was discussed briefly with the white hat, shared with other people familiar with the protocol, audited by a prior Euler auditor, and implemented following a governance vote,\u201D said Michael Bentley, CEO of Euler Labs.","However, Euler Labs did not comment on whether the earlier bug report directly led to the subsequent massive hack.","The March 13 flash-loan attack on Euler resulted in a loss of <a href=\"https:\/\/www.theblock.co\/post\/219196\/euler-finance-flash-loan-attacked-for-an-estimated-197-million\" data-v-f87c67ca=\"\">nearly $200 million<\/a><span data-v-f87c67ca=\"\"> across multiple assets. These included $136 million in staked ether (<span class=\"articleTooltip\" data-v-baf5685a=\"\" data-v-f87c67ca=\"\"><a href=\"\/price\/248354\/lido-staked-ether-steth-usd\" class=\"articleTooltip__link\" data-v-baf5685a=\"\"><img src=\"https:\/\/www.tbstat.com\/wp\/uploads\/2023\/10\/steth_logo.png\" alt=\"\" title=\"\" class=\"articleTooltip__tokenImage\" data-v-baf5685a=\"\"> <span class=\"articleTooltip__tokenText\" data-v-baf5685a=\"\">stETH<\/span> <span class=\"articleTooltip__tokenText articleTooltip__tokenText_price articleTooltip__tokenText_negative\" data-v-baf5685a=\"\">\n      -0.39%\n    <\/span><\/a> <!----><\/span>), $34 million in <span class=\"articleTooltip\" data-v-baf5685a=\"\" data-v-f87c67ca=\"\"><a href=\"\/price\/248353\/usd-coin-usdc-usd\" class=\"articleTooltip__link\" data-v-baf5685a=\"\"><img src=\"https:\/\/www.tbstat.com\/wp\/uploads\/2023\/10\/usdc.png\" alt=\"\" title=\"\" class=\"articleTooltip__tokenImage\" data-v-baf5685a=\"\"> <span class=\"articleTooltip__tokenText\" data-v-baf5685a=\"\">USDC<\/span> <span class=\"articleTooltip__tokenText articleTooltip__tokenText_price articleTooltip__tokenText_negative\" data-v-baf5685a=\"\">\n      -0.086%\n    <\/span><\/a> <!----><\/span>, $19 million in wrapped bitcoin (<span class=\"articleTooltip\" data-v-baf5685a=\"\" data-v-f87c67ca=\"\"><a href=\"\/price\/248364\/wrapped-bitcoin-wbtc-usd\" class=\"articleTooltip__link\" data-v-baf5685a=\"\"><img src=\"https:\/\/www.tbstat.com\/wp\/uploads\/2023\/10\/wrapped_bitcoin_wbtc.png\" alt=\"\" title=\"\" class=\"articleTooltip__tokenImage\" data-v-baf5685a=\"\"> <span class=\"articleTooltip__tokenText\" data-v-baf5685a=\"\">WBTC<\/span> <span class=\"articleTooltip__tokenText articleTooltip__tokenText_price articleTooltip__tokenText_negative\" data-v-baf5685a=\"\">\n      -0.17%\n    <\/span><\/a> <!----><\/span>), and $8.7 million in DAI.<\/span>","Flash loans, although useful in the DeFi sector for legitimate purposes, are often exploited by attackers due to the lack of required collateral. However, these loans come with high risk, as they must be repaid within a very short timeframe.","Following the attack, Euler\u2019s EUL token experienced a nearly 70% decrease in value, falling to $2.07. As of the most recent data from CoinGecko, the token is now trading at $2.58.","<span data-v-f87c67ca=\"\">EUL\/USD price chart. Image: <a href=\"https:\/\/www.coingecko.com\/en\/coins\/euler\" data-v-f87c67ca=\"\">CoinGecko<\/a>.<\/span>","The <a href=\"https:\/\/www.theblock.co\/post\/224705\/euler-hacker-returns-funds\" data-v-f87c67ca=\"\">attacker later returned $177 million<\/a> in a series of transactions in March and April, accounting for the expected \"recoverable funds\" from the hack after adjusting for a bounty offered by the project.","\"Following successful negotiations, all of the recoverable funds taken from the Euler protocol on March 13 have now been successfully returned by the exploiter,\u201D project developer Euler Labs said at the time.","<em data-v-f87c67ca=\"\">With reporting assistance from Vishal Chawla.<\/em>","Â© 2023 The Block. All Rights Reserved. This article is provided for informational purposes only. It is not offered or intended to be used as legal, tax, investment, financial, or other advice."],"entity":[{"type":"$1m","content":"MONEY"},{"type":"70%","content":"PERCENT"},{"type":"$8.7 million","content":"MONEY"},{"type":"$177 million","content":"MONEY"},{"type":"-0.040%","content":"PERCENT"},{"type":"$50,000","content":"MONEY"},{"type":"Euler","content":"PERSON"},{"type":"USD","content":"ORGANIZATION"},{"type":"Michael Bentley","content":"PERSON"},{"type":"DAI","content":"ORGANIZATION"},{"type":"$2.58","content":"MONEY"},{"type":"Vishal Chawla","content":"PERSON"},{"type":"Euler Finance","content":"ORGANIZATION"},{"type":"Euler Labs","content":"PERSON"},{"type":"$50k","content":"MONEY"},{"type":"$200 million","content":"MONEY"},{"type":"April","content":"DATE"},{"type":"$689,000","content":"MONEY"},{"type":"-0.39%","content":"PERCENT"},{"type":"-0.17%","content":"PERCENT"},{"type":"$34 million","content":"MONEY"},{"type":"2023","content":"DATE"},{"type":"Euler Labs","content":"ORGANIZATION"},{"type":"-5.64%","content":"PERCENT"},{"type":"Kankodu","content":"PERSON"},{"type":"$19 million","content":"MONEY"},{"type":"March 13","content":"DATE"},{"type":"$136 million","content":"MONEY"},{"type":"March","content":"DATE"},{"type":"-0.086%","content":"PERCENT"},{"type":"USDC","content":"ORGANIZATION"},{"type":"July 2022","content":"DATE"},{"type":"$2.07","content":"MONEY"}],"hashtag":["ASSETS","EXPLOITS","HACKS","SMART CONTRACTS"],"authors":["James Hunt","The Block"]}