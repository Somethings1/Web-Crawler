{"summary":"The exploit involves the RouterProcessor2 contract \u2014 which PeckShield and SushiSwap Head Chef Jared Grey recommend revoking on all chains.","webName":"theblock.co","link":"https:\/\/www.theblock.co\/post\/225473\/sushiswap-hack","publishDate":"2023-04-09T01:05:52","id":11864,"type":null,"title":"SushiSwap hacked, Head Chef says &#x27;revoke all chains&#x27;","category":["SECURITY"],"content":["Decentralized exchange SushiSwap has fallen victim to an exploit, which <a href=\"https:\/\/twitter.com\/peckshield\/status\/1644907207530774530\" data-v-f87c67ca=\"\">led<\/a> to the loss of more than $3.3 million from at least one user, known as 0xSifu on Twitter.","The exploit involves an approve-related bug on the RouterProcessor2 contract \u2014 which PeckShield and SushiSwap Head Chef Jared Grey recommend <a href=\"https:\/\/twitter.com\/jaredgrey\/status\/1644925766696677376\" data-v-f87c67ca=\"\">revoking<\/a> on all chains.","The root cause, according to Ancilia, Inc. and in technical terms, \"is because in the internal swap() function, it will call swapUniV3() to set variable \"lastCalledPool\" which is at storage slot 0x00.\"","The cybersecurity account <a href=\"https:\/\/twitter.com\/AnciliaInc\/status\/1644929849218469888\" data-v-f87c67ca=\"\">adds<\/a> that \"later on in the swap3callback function, the permission check gets bypassed.\"","In other words, by approving the bad contract, users unknowingly allow the exploiter to steal their tokens \u2014 or \"yoink,\" in this case.","\"The \"yoink\" function was used by the first attacker, which is due to the attack vector being a bug in the \"approve\" mechanism of the SushiSwap router contract,\" The Block Research Analyst Brad Kay says.","\"The bug allows an unauthorized entity to essentially \"yoink\" tokens without the proper approval from the token owner,\" Kay explains, adding: \"Following the first attack for 100 ETH \u2014 <a href=\"https:\/\/twitter.com\/trust__90\/status\/1644895249058131971?s=20\" data-v-f87c67ca=\"\">possibly a white hat<\/a> \u2014 it seems like another hacker came along and <a href=\"https:\/\/twitter.com\/trust__90\/status\/1644900643608358913?s=20\" data-v-f87c67ca=\"\">stole<\/a> another 1800-ish ETH using the same contract but instead named their function \"notyoink.\"","Early reports claim that not too many SushiSwap users are currently at risk.","DeFi Llama's @0xngmi <a href=\"https:\/\/twitter.com\/0xngmi\/status\/1644927715923963904\" data-v-f87c67ca=\"\">claims<\/a> only those who swapped on SushiSwap within the last four days should be affected. They also published <a href=\"https:\/\/gist.github.com\/0xngmi\/40c530a6dc219e62939ed911b5d5ac70\" data-v-f87c67ca=\"\">a list of contracts<\/a> across all chains that should be revoked and built a tool to <a href=\"https:\/\/0xngmi.github.io\/sushi-test-hack\/\" data-v-f87c67ca=\"\">check<\/a> if any of your addresses have been impacted.","The Block Research Analyst Kevin Peng explains that, so far, 190 Ethereum addresses have approved the problematic contract. However, more than 2000 addresses on Layer 2 Arbitrum have seemingly approved the bad contract.","The price of Sushi's governance token fell by only 0.6% in the hour since the news broke.","Grey \u2014 who&nbsp;is also <a href=\"https:\/\/www.theblock.co\/post\/221723\/sushi-hit-with-sec-subpoena-seeking-3-million-usdt-legal-defense-fund\" data-v-f87c67ca=\"\">seeking<\/a> a $3 million legal defense fund from Sushi DAO after Sushi was hit with a subpoena from the U.S. Securities and Exchange Commission \u2014 tweeted that Sushi is&nbsp;\"working with security teams to mitigate the issue.\"","<em data-v-f87c67ca=\"\">Updated to provide more context and explanation. This story is developing and will be continually updated with new information.<\/em>","Â© 2023 The Block. All Rights Reserved. This article is provided for informational purposes only. It is not offered or intended to be used as legal, tax, investment, financial, or other advice."],"entity":[{"type":"$3.3 million","content":"MONEY"},{"type":"Brad Kay","content":"PERSON"},{"type":"2000","content":"DATE"},{"type":"2023","content":"DATE"},{"type":"0.6%","content":"PERCENT"},{"type":"$3 million","content":"MONEY"},{"type":"1800","content":"DATE"},{"type":"Block Research","content":"ORGANIZATION"},{"type":"Kevin Peng","content":"PERSON"},{"type":"Ancilia, Inc.","content":"ORGANIZATION"},{"type":"SushiSwap Head Chef Jared Grey","content":"ORGANIZATION"},{"type":"U.S. Securities and Exchange Commission","content":"ORGANIZATION"},{"type":"Sushi","content":"PERSON"},{"type":"Sushi DAO","content":"ORGANIZATION"},{"type":"Sushi","content":"ORGANIZATION"}],"hashtag":["DEXS","EXPLOITS","HACKS"],"authors":["Adam James","The Block"]}